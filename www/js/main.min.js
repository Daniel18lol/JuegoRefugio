!function(){var n,t,a,o=(t=(n=function(e,n){switch(e=e||i,n.type){case"NAVIGATE":return Object.assign(e,{selectedScreen:n.screen});case"LOAD_APP":case"THANKS":return Object.assign(e,{isLoading:!1});default:return e}})(null,{}),a=[],e.prototype.dispatch=function(e){t=n(t,e),a.forEach(function(e){e(t)})},e.prototype.subscribe=function(n){return a.push(n),function(){a=a.filter(function(e){return e!==n})}},e.prototype.getState=function(){return t},new e);function e(){}var i={selectedScreen:"connection",isLoading:!0};window.onload=function(){signOut(),bookimg=document.getElementById("imgMascota"),bookname=document.getElementById("book-open-pet-name"),bookfound=document.getElementById("book-open-pet-found"),bookage=document.getElementById("book-open-pet-age"),bookrace=document.getElementById("book-open-pet-race");var t={home:document.getElementById("homeScreen"),refuge:document.getElementById("refugeScreen"),instruction:document.getElementById("instructionScreen"),store:document.getElementById("storeScreen"),map:document.getElementById("mapScreen"),bookend:document.getElementById("bookendScreen"),bookfront:document.getElementById("bookfrontScreen"),bookopen:document.getElementById("bookopenScreen"),info:document.getElementById("infoScreen"),credits:document.getElementById("creditsScreen"),tepa:document.getElementById("tepaScreen"),connection:document.getElementById("loginScreen"),signup:document.getElementById("signupScreen"),restaurant:document.getElementById("restaurantScreen"),park:document.getElementById("parkScreen"),awards:document.getElementById("awardScreen"),support:document.getElementById("supportUsScreen"),downtown:document.getElementById("downtownScreen")},a=o.subscribe(function(e){var n;e.isLoading||((n=document.getElementById("thanksScreen")).classList.remove("loading"),n.addEventListener("transitionend",function(e){"opacity"===e.propertyName&&n.parentElement.removeChild(n)}),a())});o.subscribe(function(n){Object.keys(t).forEach(function(e){e!==n.selectedScreen?t[e].classList.remove("active"):t[e].classList.add("active")})}),setTimeout(function(){o.dispatch({type:"LOAD_APP"});var t=o.subscribe(function(e){var n;e.isLoading||((n=document.getElementById("splashScreen")).classList.remove("loading"),n.addEventListener("transitionend",function(e){"opacity"===e.propertyName&&n.parentElement.removeChild(n)}),t())});setTimeout(function(){o.dispatch({type:"THANKS"})},4e3)},1e4),loadRefuge(),navigate=function(e){o.dispatch({type:"NAVIGATE",screen:e})}}}();var animalAge,winner,previousImage,email,navigate=function(e){},winProbability=.2,attempts=5,animalsImages=[["img/Artboard_1Animals.svg","img/Artboard_2Animals.svg","img/Artboard_3Animals.svg"],["img/Artboard_4Animals.svg","img/Artboard_6Animals.svg","img/Artboard_7Animals.svg"],["img/Artboard_8Animals.svg","img/Artboard_9Animals.svg","img/Artboard_10Animals.svg"],["img/Artboard_11Animals.svg","img/Artboard_12Animals.svg","img/Artboard_13Animals.svg"],["img/Artboard_14Animals.svg","img/Artboard_15Animals.svg","img/Artboard_16Animals.svg"],["img/Artboard_17Animals.svg","img/Artboard_18Animals.svg","img/Artboard_19Animals.svg"],["img/Artboard_20Animals.svg","img/Artboard_21Animals.svg","img/Artboard_22Animals.svg"],["img/Artboard_23Animals.svg","img/Artboard_24Animals.svg","img/Artboard_25Animals.svg"]],animalsName=["Rocky","Max","Lupe","Ares","Atenea","Tommy","Chelsea","Trueno","Liz"],animalsRace=["Mixed","Pure","Pedigree"],animalesGanados=[],animalsDB=[];function reloadImages(e,n,t){null!=t&&null!=t&&(document.getElementById(t).style.backgroundImage="url("+n+")");for(var a=0;a<e.length;a++)e[a].style.display="block"}function refillRefuge(){var n;animalesGanados=JSON.parse(localStorage.getItem("animals"));var t=0;t<6?animalesGanados.forEach(function(e){t++,n=document.getElementById("animal"+t),document.getElementById("shelter-"+t).style.visibility="visible",n.setAttribute("src",e.imageURL)}):window.alert("There's no more shelters")}function processObject(e,n){var t,a,o,i,s,r=document.getElementById(e),m=document.getElementById(n).getElementsByTagName("DIV"),l=n.split("-"),d=document.getElementById("topSignText-"+l[0]);0<attempts?(t=Math.random(),e==winner?(refillRefuge(),reloadImages(m,previousImage,winner),navigate("refuge"),animalsDB=[],animalesGanados=[],getInfo()):t<=winProbability?(console.log("ganaste"),console.log(r),a=Math.floor(Math.random()*animalsImages.length),o=Math.floor(+Math.random()+1),i=n.split("-"),animalAge=Math.floor(14*Math.random()+1),s=window.getComputedStyle(r).getPropertyValue("background-image").split("www"),previousImage="../www"+s[1].substring(0,s[1].length-2),console.log(previousImage),r.style.backgroundImage="url('"+animalsImages[a][o]+"')",animalGanado={imageURL:animalsImages[a][0],name:animalsName[Math.floor(Math.random()*animalsName.length)],found:i[0],age:animalAge,race:animalsRace[Math.floor(Math.random()*animalsRace.length)]},saveInfo(animalGanado),animalesGanados.push(animalGanado),animalesGanados.length<6&&window.localStorage.setItem("animals",JSON.stringify(animalesGanados)),winProbability=.2,attempts=5,winner=r.id):(attempts--,winProbability+=.1,r.style.display="none"),d.placeholder="Tries left: "+attempts):(refillRefuge(),reloadImages(m,previousImage,null),window.alert("No more attempts available"),winProbability=.2,attempts=5,navigate("refuge"))}function callInstructions(){document.getElementById("videoInstructions").play(),navigate("instruction"),setTimeout(function(){navigate("home")},35500)}function register(){var e=document.getElementById("emailInputSignup").value,n=document.getElementById("passwordInputSignup").value;console.log(e),firebase.auth().createUserWithEmailAndPassword(e,n).catch(function(e){e.code,e.message;alert("La cuenta no se creó correctamente")}),n.html}function login(){var e=document.getElementById("userInputLogin").value,n=document.getElementById("passwordInputLogin").value;firebase.auth().signInWithEmailAndPassword(e,n).catch(function(e){e.code,e.message;alert("Por favor verifique que sus datos sean válidos")}),n.html}function userLoged(){firebase.auth().onAuthStateChanged(function(e){e&&(navigate("home"),email=e.email,getInfo(),loadBook())})}function signOut(){firebase.auth().signOut().then(function(){}).catch(function(e){})}userLoged();var db=firebase.firestore();function saveInfo(e){db.collection("users").doc(email).collection("animals").add(e).then(function(e){console.log("Document written with ID: ",e.id)}).catch(function(e){console.error("Error adding document: ",e)})}function getInfo(){db.collection("users").doc(email).collection("animals").get().then(function(e){e.forEach(function(e){animalsDB.push(e.data())}),loadRefuge(),loadBook()})}function loadRefuge(){null!=animalsDB&&null!=animalesGanados||(animalesDB=[],animalesGanados=[]);var n,t=0;console.log(animalsDB),animalsDB.forEach(function(e){console.log(e),t++,n=document.getElementById("animal"+t),document.getElementById("shelter-"+t).style.visibility="visible",n.setAttribute("src",e.imageURL),animalesGanados.push(e)})}function loadBook(){firstAnimal=animalsDB[0],firstAnimal&&(bookimg.src=firstAnimal.imageURL,bookname.innerHTML="NAME: "+firstAnimal.name,bookfound.innerHTML="FOUND: "+firstAnimal.found,bookage.innerHTML="AGE: "+firstAnimal.age,bookrace.innerHTML="RACE: "+firstAnimal.race)}function nextAnimal(){index++,bookAnimal=animalsDB[index],bookAnimal?(bookimg.src=bookAnimal.imageURL,bookname.innerHTML="NAME: "+bookAnimal.name,bookfound.innerHTML="FOUND: "+bookAnimal.found,bookage.innerHTML="AGE: "+bookAnimal.age,bookrace.innerHTML="RACE: "+bookAnimal.race):(navigate("bookend"),index=0,loadBook())}index=0;